<div class="col-md-6">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Reserve now</h3>
    </div>
    <div class="panel-body">
      <div class="row">
      <div class="col-md-12">
        <p>
          <span class="bold">This space is available from</span>
          <%= l @space.date_from, format: :long %> to
          <%= l @space.date_until, format: :long %>
          <%= @space.weekend %>
        </p>
        <%= form_for([@space, @space.bookings.build], :html => { :class => 'form-inline' } )do |f| %>
            <div class='input-group date col-md-4' id='date_from'>
              <%= f.label :date_from, class: 'sr-only' %>
              <%= f.text_field :date_from, required: true, placeholder: 'Date-time', class: 'form-control', readonly: true %>
              <span class="input-group-addon">
                  <span class="glyphicon glyphicon-calendar"></span> From
                </span>
            </div>
            <div class='input-group date col-md-4' id='date_until'>
              <%= f.label :date_until, class: 'sr-only' %>
              <%= f.text_field :date_until, required: true, placeholder: 'Date-time', class: 'form-control', readonly: true %>
              <span class="input-group-addon">
                <span class="glyphicon glyphicon-calendar"></span> Until
              </span>
            </div>
            <%= f.submit "Reserve Now", class: 'btn btn-success' %>
        <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Last bookings accepted</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-12">
          <% if @bookings.empty? %>
          <p>No bookings accepted available</p>
          <% else %>
           <table class="table table-hover">
            <thead>
              <tr>
                <th>Space</th>
                <th>Date From</th>
                <th>Date Until</th>
              </tr>
            </thead>
            <tbody>
              <%= render partial: 'bookings/booking', collection: @bookings, locals: { state: '' } %>
            </tbody>
          </table>
          <%= will_paginate @bookings, param_name: 'booking_page', renderer: BootstrapPagination::Rails %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(function() {
    $("#date_from").datetimepicker({
      format: 'YYYY-MM-DD hh:mm a',
      ignoreReadonly: true
    }).on("dp.change", function (e) {
        $("#date_until").data("DateTimePicker").minDate(e.date);
      }).ready(function() {
        $("#date_until").data("DateTimePicker").minDate($("#date_from").data("DateTimePicker").date());
      });

      $("#date_until").datetimepicker({
        format: 'YYYY-MM-DD hh:mm a',
        ignoreReadonly: true
      }).on("dp.change", function (e) {
        $("#date_from").data("DateTimePicker").maxDate(e.date);
      }).ready(function() {
        $("#date_from").data("DateTimePicker").maxDate($("#date_until").data("DateTimePicker").date());
      });
    });
</script>
